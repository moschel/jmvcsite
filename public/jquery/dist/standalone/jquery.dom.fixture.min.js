(function(c){c.ajaxPrefilter(function(a){if(c.fixture.on){x(a);if(a.fixture){if(typeof a.fixture==="string"&&c.fixture[a.fixture])a.fixture=c.fixture[a.fixture];if(typeof a.fixture=="string"){var b=a.fixture;if(/^\/\//.test(b))b=steal.root.join(a.fixture.substr(2));a.url=b;a.data=null;a.type="GET";if(!a.error)a.error=function(d,e,f){throw"fixtures.js Error "+e+" "+f;}}else a.dataTypes.splice(0,0,"fixture")}}});c.ajaxTransport("fixture",function(a,b){a.dataTypes.shift();var d=a.dataTypes[0],e;return{send:function(f,
q){e=setTimeout(function(){var i=a.fixture(b,a,f);if(!c.isArray(i)){var m=[{}];m[0][d]=i;i=m}typeof i[0]!="number"&&i.unshift(200,"success");if(!i[2]||!i[2][d]){m={};m[d]=i[2];i[2]=m}q.apply(null,i)},c.fixture.delay)},abort:function(){clearTimeout(e)}}});var v=/^(script|json|test|jsonp)$/,r=[],y=function(a,b,d){a=c.extend({},a);for(var e in b){if(e!=="fixture")if(b[e]!==a[e])return false;d&&delete a[e]}if(d)for(var f in a)return false;return true},w=function(a,b){for(var d=0;d<r.length;d++)if(y(a,
r[d],b))return d;return-1},x=function(a){var b=w(a);if(b>-1)a.fixture=r[b].fixture},t=function(a){var b=a.data.id;b===undefined&&a.url.replace(/\/(\d+)(\/|$)/g,function(d,e){b=e});if(b===undefined)b=a.url.replace(/\/(\w+)(\/|$)/g,function(d,e){if(e!="update")b=e});if(b===undefined)b=Math.round(Math.random()*1E3);return b};c.fixture=function(a,b){if(b!==undefined){if(typeof a=="string")a={url:a};var d=w(a,!!b);d>=-1&&r.splice(d,1);if(b!=null){a.fixture=b;r.push(a)}}};c.extend(c.fixture,{"-restUpdate":function(a){return[{id:t(a)},
{location:a.url+"/"+t(a)}]},"-restDestroy":function(){return{}},"-restCreate":function(a){var b=parseInt(Math.random()*1E5,10);return[{id:b},{location:a.url+"/"+b}]},make:function(a,b,d,e){if(typeof a==="string")a=[a+"s",a];for(var f=c.fixture["~"+a[0]]=[],q=function(g){for(var h=0;h<f.length;h++)if(g==f[h].id)return f[h]},i=0;i<b;i++){var m=d(i,f);if(!m.id)m.id=i;f.push(m)}c.fixture["-"+a[0]]=function(g){var h=f.slice(0);c.each((g.data.order||[]).slice(0).reverse(),function(z,u){var k=u.split(" ");
h=h.sort(function(n,o){return k[1].toUpperCase()!=="ASC"?n[k[0]]<o[k[0]]?1:n[k[0]]==o[k[0]]?0:-1:n[k[0]]<o[k[0]]?-1:n[k[0]]==o[k[0]]?0:1})});c.each((g.data.group||[]).slice(0).reverse(),function(z,u){var k=u.split(" ");h=h.sort(function(n,o){return n[k[0]]>o[k[0]]})});var j=parseInt(g.data.offset,10)||0,p=parseInt(g.data.limit,10)||b-j,l=0;for(var s in g.data){l=0;if(g.data[s]&&(s.indexOf("Id")!=-1||s.indexOf("_id")!=-1))for(;l<h.length;)if(g.data[s]!=h[l][s])h.splice(l,1);else l++}if(e)for(l=0;l<
h.length;)if(e(h[l],g))l++;else h.splice(l,1);return[{count:h.length,limit:g.data.limit,offset:g.data.offset,data:h.slice(j,j+p)}]};c.fixture["-"+a[1]]=function(g){return[q(g.data.id)]};c.fixture["-"+a[1]+"Update"]=function(g,h){var j=t(g);c.extend(q(j),g.data);return c.fixture["-restUpdate"](g,h)};c.fixture["-"+a[1]+"Destroy"]=function(g,h){for(var j=t(g),p=0;p<f.length;p++)if(f[p].id==j){f.splice(p,1);break}c.extend(q(j),g.data);return c.fixture["-restDestroy"](g,h)};c.fixture["-"+a[1]+"Create"]=
function(g,h){var j=d(f.length,f);c.extend(j,g.data);if(!j.id)j.id=f.length;f.push(j);return c.fixture["-restCreate"](g,h)}},xhr:function(a){return c.extend({},{abort:c.noop,getAllResponseHeaders:function(){return""},getResponseHeader:function(){return""},open:c.noop,overrideMimeType:c.noop,readyState:4,responseText:"",responseXML:null,send:c.noop,setRequestHeader:c.noop,status:200,statusText:"OK"},a)},on:true});c.fixture.delay=200;c.fixture["-handleFunction"]=function(a){if(typeof a.fixture==="string"&&
c.fixture[a.fixture])a.fixture=c.fixture[a.fixture];if(typeof a.fixture=="function"){setTimeout(function(){a.success&&a.success.apply(null,a.fixture(a,"success"));a.complete&&a.complete.apply(null,a.fixture(a,"complete"))},c.fixture.delay);return true}return false};c.get=function(a,b,d,e,f){if(jQuery.isFunction(b)){if(!v.test(e||"")){f=e;e=d}d=b;b=null}if(jQuery.isFunction(b)){f=e;e=d;d=b;b=null}return jQuery.ajax({type:"GET",url:a,data:b,success:d,dataType:e,fixture:f})};c.post=function(a,b,d,e,
f){if(jQuery.isFunction(b)){if(!v.test(e||"")){f=e;e=d}d=b;b={}}return jQuery.ajax({type:"POST",url:a,data:b,success:d,dataType:e,fixture:f})}})(jQuery);
