(function(f){f.Controller.extend("jQuery.Tie",{init:function(c,b,a,d){if(!d){c=this.element.data("controllers")||{};for(var e in c)if(typeof c[e].val=="function"){d=e;break}}this.type=d;this.attr=a;this.inst=b;this.bind(b,a,"attrChanged");this.bind(b,"destroyed","modelDestroyed");this.lastValue=b=b.attr(a);if(d){this.bind(this.element.data("controllers")[d],"destroyed","destroy");this.element[d]("val",b)}else this.element.val(b)},attrChanged:function(c,b,a){if(a!==this.lastValue){this.setVal(a);this.lastValue=
a}},modelDestroyed:function(){this.destroy()},setVal:function(c){this.type?this.element[this.type]("val",c):this.element.val(c)},change:function(c,b,a){if(!this.type&&a===undefined)a=this.element.val();this.inst.attr(this.attr,a,null,this.callback("setBack"))},setBack:function(){this.setVal(this.lastValue)},destroy:function(){this.inst=null;this._destroyed||this._super()}})})(jQuery);
