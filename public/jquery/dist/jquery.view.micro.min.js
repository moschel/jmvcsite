(function(f){var k=function(a){return a.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},l=1,d,p,r;isDeferred=function(a){return a&&f.isFunction(a.always)};getDeferreds=function(a){var b=[];if(isDeferred(a))return[a];else for(var c in a)isDeferred(a[c])&&b.push(a[c]);return b};usefulPart=function(a){return f.isArray(a)&&a.length===3&&a[1]==="success"?a[0]:a};d=f.View=function(a,b,c,e){if(typeof c==="function"){e=c;c=undefined}var g=getDeferreds(b);if(g.length){var h=f.Deferred();g.push(r(a,true));f.when.apply(f,
g).then(function(j){var m=f.makeArray(arguments),n=m.pop()[0];if(isDeferred(b))b=usefulPart(j);else for(var o in b)if(isDeferred(b[o]))b[o]=usefulPart(m.shift());m=n(b,c);h.resolve(m);e&&e(m)});return h.promise()}else{var i;g=typeof e==="function";h=r(a,g);if(g){i=h;h.done(function(j){e(j(b,c))})}else h.done(function(j){i=j(b,c)});return i}};p=function(a,b){if(!a.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+b;};r=function(a,b){return f.ajax({url:a,dataType:"view",
async:b})};f.ajaxTransport("view",function(a,b){a=b.url;var c=a.match(/\.[\w\d]+$/),e,g,h,i=a,j,m=function(n){n=e.renderer(h,n);if(d.cache)d.cached[h]=n;return{view:n}};if(g=document.getElementById(a))c=g.type.match(/\/[\d\w]+$/)[0].replace(/^\//,".");if(!c){c=d.ext;i+=d.ext}h=k(i);if(i.match(/^\/\//))i=typeof steal==="undefined"?"/"+i.substr(2):steal.root.join(i.substr(2));e=d.types[c];return{send:function(n,o){if(d.cached[h])return o(200,"success",{view:d.cached[h]});else if(g)o(200,"success",m(g.innerHTML));
else j=f.ajax({async:b.async,url:i,dataType:"text",error:function(){p("",i);o(404)},success:function(u){p(u,i);o(200,"success",m(u))}})},abort:function(){j&&j.abort()}}});f.extend(d,{hookups:{},hookup:function(a){var b=++l;d.hookups[b]=a;return b},cached:{},cache:true,register:function(a){this.types["."+a.suffix]=a},types:{},ext:".ejs",registerScript:function(a,b,c){return"$.View.preload('"+b+"',"+d.types["."+a].script(b,c)+");"},preload:function(a,b){d.cached[a]=function(c,e){return b.call(c,c,e)}}});
var v,q,w,x,y,s;v=function(a){var b=f.fn[a];f.fn[a]=function(){var c=f.makeArray(arguments),e,g,h=this;if(w(c)){if(e=x(c)){g=c[e];c[e]=function(i){q.call(h,[i],b);g.call(h,i)};d.apply(d,c);return this}c=d.apply(d,c);if(isDeferred(c)){c.done(function(i){q.call(h,[i],b)});return this}else c=[c]}return q.call(this,c,b)}};q=function(a,b){var c;for(var e in d.hookups)break;if(e){c=d.hookups;d.hookups={};a[0]=f(a[0])}b=b.apply(this,a);e&&y(a[0],c);return b};w=function(a){var b=typeof a[1];return typeof a[0]==
"string"&&(b=="object"||b=="function")&&!a[1].nodeType&&!a[1].jquery};x=function(a){return typeof a[3]==="function"?3:typeof a[2]==="function"&&2};y=function(a,b){var c,e=0,g,h;a=a.filter(function(){return this.nodeType!=3});a=a.add("[data-view-id]",a);for(c=a.length;e<c;e++)if(a[e].getAttribute&&(g=a[e].getAttribute("data-view-id"))&&(h=b[g])){h(a[e],g);delete b[g];a[e].removeAttribute("data-view-id")}f.extend(d.hookups,b)};s=["prepend","append","after","before","text","html","replaceWith","val"];
for(var t=0;t<s.length;t++)v(s[t])})(jQuery);
(function(){function f(k,l){k="var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+k.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%})/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/{%=(.+?)%}/g,"',$1,'").split("{%").join("');").split("%}").join("p.push('")+"');}return p.join('');";var d=new Function("obj",k);d.body=k;return l?d(l):d}$.View.register({suffix:"micro",renderer:function(k,l){var d=f(l);return function(p){return d(p)}},script:function(k,l){return"function(obj){"+
f(l).body+"}"}});jQuery.View.ext=".micro"})(jQuery);
