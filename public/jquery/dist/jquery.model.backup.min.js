(function(e){var g=function(a,c){var b,d;for(b in a.Class.associations){association=a.Class.associations[b];if("belongsTo"in association)if(a[b]&&(d=c(a[b])))return d;if("hasMany"in association)if(a[b])for(var f=0;f<a[b].length;f++)if(d=c(a[b][f]))return d}};e.extend(e.Model.prototype,{backup:function(){g(this,function(a){a.backup()});this._backupStore=e.extend(true,{},this.attrs());return this},_backup:function(){this._backupStore=e.extend(true,{},this.attrs())},isDirty:function(a){if(!this._backupStore)return false;
var c=this.attrs(),b;for(b in c)if(c[b]!==this._backupStore[b])return true;if(a){a=g(this,function(d){return d.isDirty()});if(a===true)return true}return false},restore:function(a){this.attrs(this._backupStore);a&&g(this,function(c){c.restore()});return this}})})(true);
