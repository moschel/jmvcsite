(function(h){var k=function(b){return b.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},s=1,e,d,o,a;e=h.View=function(b,j,i,l){var m=b.match(/\.[\w\d]+$/),p,r,t=b;if(typeof i==="function"){l=i;i=undefined}if(!m){m=h.View.ext;t+=h.View.ext}r=k(t);if(t.match(/^\/\//))t=steal.root.join(t.substr(2));m=h.View.types[m];return(b=h.View.cached[r]?h.View.cached[r]:(p=document.getElementById(b))?m.renderer(r,p.innerHTML):a(m,r,t,j,i,l))&&d(b,m,r,j,i,l)};d=function(b,j,i,l,m,p){if(h.View.cache)h.View.cached[i]=
b;b=b.call(j,l,m);p&&p(b);return b};o=function(b,j){if(!b.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+j;};a=function(b,j,i,l,m,p){if(p)h.ajax({url:i,dataType:"text",error:function(){o("",i)},success:function(t){o(t,i);d(b.renderer(j,t),b,j,l,m,p)}});else{var r=h.ajax({async:false,url:i,dataType:"text",error:function(){o("",i)}}).responseText;o(r,i);return b.renderer(j,r)}};h.extend(h.View,{hookups:{},hookup:function(b){var j=++s;e.hookups[j]=b;return j},cached:{},
cache:true,register:function(b){this.types["."+b.suffix]=b},types:{},ext:".ejs",registerScript:function(b,j,i){return"$.View.preload('"+j+"',"+h.View.types["."+b].script(j,i)+");"},preload:function(b,j){h.View.cached[b]=function(i,l){return j.call(i,i,l)}}});var c,f,g,n,v,u;c=function(b){var j=jQuery.fn[b];jQuery.fn[b]=function(){var i=h.makeArray(arguments),l,m,p=this;if(g(i)){if(l=n(i)){m=i[l];i[l]=function(r){f.call(p,[r],j);m.call(p,r)};h.View.apply(h.View,i);return this}i=[h.View.apply(h.View,
i)]}return f.call(this,i,j)}};f=function(b,j){for(var i in jQuery.View.hookups);if(i)b[0]=h(b[0]);j=j.apply(this,b);i&&v(b[0]);return j};g=function(b){var j=typeof b[1];return typeof b[0]=="string"&&(j=="object"||j=="function")&&!b[1].nodeType&&!b[1].jquery};n=function(b){return typeof b[3]==="function"?3:typeof b[2]==="function"&&2};v=function(b){var j=jQuery.View.hookups,i,l=0,m,p;jQuery.View.hookups={};b=b.add("[data-view-id]",b);for(i=b.length;l<i;l++)if(b[l].getAttribute&&(m=b[l].getAttribute("data-view-id"))&&
(p=j[m])){p(b[l],m);delete j[m];b[l].removeAttribute("data-view-id")}h.extend(jQuery.View.hookups,j)};u=["prepend","append","after","before","replace","text","html","replaceWith"];for(var q=0;q<u.length;q++)c(u[q])})(true);
(function(h){var k={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowerUpper:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g},s=h.String={strip:function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},capitalize:function(e){return e.charAt(0).toUpperCase()+e.substr(1)},endsWith:function(e,d){var o=e.length-d.length;return o>=0&&e.lastIndexOf(d)===o},camelize:function(e){e=e.split(k.undHash);var d=1;for(e[0]=e[0].charAt(0).toLowerCase()+e[0].substr(1);d<e.length;d++)e[d]=s.capitalize(e[d]);
return e.join("")},classize:function(e){e=e.split(k.undHash);for(var d=0;d<e.length;d++)e[d]=s.capitalize(e[d]);return e.join("")},niceName:function(e){e=e.split(k.undHash);for(var d=0;d<e.length;d++)e[d]=s.capitalize(e[d]);return e.join(" ")},underscore:function(e){return e.replace(k.colons,"/").replace(k.words,"$1_$2").replace(k.lowerUpper,"$1_$2").replace(k.dash,"_").toLowerCase()}}})(true);
(function(h){h.String.rsplit=function(k,s){for(var e=s.exec(k),d=[],o;e!==null;){o=e.index;if(o!==0){d.push(k.substring(0,o));k=k.slice(o)}d.push(e[0]);k=k.slice(e[0].length);e=s.exec(k)}k!==""&&d.push(k);return d}})(true);
(function(h){var k=function(a){return a.substr(0,a.length-1)},s=h.extend,e=h.isArray,d=function(a){if(this.constructor!=d){var c=new d(a);return function(g,n){return c.render(g,n)}}if(typeof a=="function"){this.template={};this.template.process=a}else{h.extend(this,d.options,a);var f=new d.Compiler(this.text,this.type);f.compile(a,this.name);this.template=f}},o=/(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/;h.EJS=d;d.prototype={constructor:d,render:function(a,c){a=a||{};this._extra_helpers=
c;c=new d.Helpers(a,c||{});return this.template.process.call(a,a,c)},out:function(){return this.template.out}};d.text=function(a){if(typeof a=="string")return a;var c;if(a===null||a===undefined)return"";if(a instanceof Date)return a.toDateString();if(a.hookup){c=h.View.hookup(function(f,g){a.hookup.call(a,f,g)});return"data-view-id='"+c+"'"}if(typeof a=="function")return"data-view-id='"+h.View.hookup(a)+"'";if(e(a)){c=h.View.hookup(function(f,g){for(var n=0;n<a.length;n++)a[n].hookup?a[n].hookup(f,
g):a[n](f,g)});return"data-view-id='"+c+"'"}if(a.nodeName||a.jQuery)throw"elements in views are not supported";if(a.toString)return c?a.toString(c):a.toString();return""};d.Scanner=function(a,c,f){s(this,{leftDelimiter:c+"%",rightDelimiter:"%"+f,doubleLeft:c+"%%",doubleRight:"%%"+f,leftEqual:c+"%=",leftComment:c+"%#"});this.splitRegexp=c=="["?o:new RegExp("("+[this.doubleLeft,this.doubleRight,this.leftEqual,this.leftComment,this.leftDelimiter,this.rightDelimiter+"\n",this.rightDelimiter,"\n"].join(")|(")+
")");this.source=a;this.lines=0};d.Scanner.prototype={scan:function(a){var c=this.splitRegexp;if(this.source)for(var f=h.String.rsplit(this.source,/\n/),g=0;g<f.length;g++)this.scanline(f[g],c,a)},scanline:function(a,c,f){this.lines++;a=h.String.rsplit(a,c);for(var g=0;g<a.length;g++){c=a[g];if(c!==null)try{f(c,this)}catch(n){throw{type:"jQuery.EJS.Scanner",line:this.lines};}}}};d.Buffer=function(a,c){this.line=[];this.script=[];this.post_cmd=c;this.push.apply(this,a)};d.Buffer.prototype={push:function(){this.line.push.apply(this.line,
arguments)},cr:function(){this.script.push(this.line.join(""),"\n");this.line=[]},close:function(){if(this.line.length>0){this.script.push(this.line.join(""));this.line=[]}this.post_cmd.length&&this.push.apply(this,this.post_cmd);this.script.push(";");return this.script.join("")}};d.Compiler=function(a,c){this.source=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n");c=c||"<";a=">";switch(c){case "[":a="]";break;case "<":break;default:throw c+" is not a supported deliminator";}this.scanner=new d.Scanner(this.source,
c,a);this.out=""};d.Compiler.prototype={compile:function(a,c){a=a||{};this.out="";var f=new d.Buffer(["var ___v1ew = [];"],[]),g="",n=function(q){return q.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')},v=function(q){f.push("___v1ew.push(",'"',n(q),'");')},u=null;this.scanner.scan(function(q,b){if(u===null)switch(q){case "\n":g+="\n";v(g);f.cr();g="";break;case b.leftDelimiter:case b.leftEqual:case b.leftComment:u=q;g.length>0&&v(g);g="";break;case b.doubleLeft:g+=b.leftDelimiter;
break;default:g+=q;break}else switch(q){case b.rightDelimiter:switch(u){case b.leftDelimiter:if(g[g.length-1]=="\n"){g=k(g);f.push(g,";");f.cr()}else f.push(g,";");break;case b.leftEqual:f.push("___v1ew.push(","(jQuery.EJS.text(",g,")));");break}u=null;g="";break;case b.doubleRight:g+=b.rightDelimiter;break;default:g+=q;break}});g.length>0&&f.push("___v1ew.push(",'"',n(g)+'");');a=f.close();this.out="/*"+c+"*/  try { with(_VIEW) { with (_CONTEXT) {"+a+" return ___v1ew.join('');}}}catch(e){e.lineNumber=null;throw e;}";
eval("this.process = (function(_CONTEXT,_VIEW){"+this.out+"})")}};d.options={cache:true,type:"<",ext:".ejs"};d.Helpers=function(a,c){this._data=a;this._extras=c;s(this,c)};d.Helpers.prototype={plugin:function(){var a=h.makeArray(arguments),c=a.shift();return function(f){f=h(f);f[c].apply(f,a)}},view:function(a,c,f){f=f||this._extras;c=c||this._data;return h.View(a,c,f)}};h.View.register({suffix:"ejs",script:function(a,c){return"jQuery.EJS(function(_CONTEXT,_VIEW) { "+(new d({text:c})).out()+" })"},
renderer:function(a,c){var f=new d({text:c,name:a});return function(g,n){return f.render.call(f,g,n)}}})})(true);
