(function(f){var l=function(b){return b.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},t=1,o,e,c,r;o=f.View=function(b,g,j,k){var m=b.match(/\.[\w\d]+$/),p,q,s=b;if(typeof j==="function"){k=j;j=undefined}if(!m){m=f.View.ext;s+=f.View.ext}q=l(s);if(s.match(/^\/\//))s=steal.root.join(s.substr(2));m=f.View.types[m];return(b=f.View.cached[q]?f.View.cached[q]:(p=document.getElementById(b))?m.renderer(q,p.innerHTML):r(m,q,s,g,j,k))&&e(b,m,q,g,j,k)};e=function(b,g,j,k,m,p){if(f.View.cache)f.View.cached[j]=
b;b=b.call(g,k,m);p&&p(b);return b};c=function(b,g){if(!b.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+g;};r=function(b,g,j,k,m,p){if(p)f.ajax({url:j,dataType:"text",error:function(){c("",j)},success:function(s){c(s,j);e(b.renderer(g,s),b,g,k,m,p)}});else{var q=f.ajax({async:false,url:j,dataType:"text",error:function(){c("",j)}}).responseText;c(q,j);return b.renderer(g,q)}};f.extend(f.View,{hookups:{},hookup:function(b){var g=++t;o.hookups[g]=b;return g},cached:{},
cache:true,register:function(b){this.types["."+b.suffix]=b},types:{},ext:".ejs",registerScript:function(b,g,j){return"$.View.preload('"+g+"',"+f.View.types["."+b].script(g,j)+");"},preload:function(b,g){f.View.cached[b]=function(j,k){return g.call(j,j,k)}}});var a,d,i,h,n,v;a=function(b){var g=f.fn[b];f.fn[b]=function(){var j=f.makeArray(arguments),k,m,p=this;if(i(j)){if(k=h(j)){m=j[k];j[k]=function(q){d.call(p,[q],g);m.call(p,q)};f.View.apply(f.View,j);return this}j=[f.View.apply(f.View,j)]}return d.call(this,
j,g)}};d=function(b,g){var j;for(var k in jQuery.View.hookups)break;if(k){j=f.View.hookups;f.View.hookups={};b[0]=f(b[0])}g=g.apply(this,b);k&&n(b[0],j);return g};i=function(b){var g=typeof b[1];return typeof b[0]=="string"&&(g=="object"||g=="function")&&!b[1].nodeType&&!b[1].jquery};h=function(b){return typeof b[3]==="function"?3:typeof b[2]==="function"&&2};n=function(b,g){var j,k=0,m,p;b=b.filter(function(){return this.nodeType!=3});b=b.add("[data-view-id]",b);for(j=b.length;k<j;k++)if(b[k].getAttribute&&
(m=b[k].getAttribute("data-view-id"))&&(p=g[m])){p(b[k],m);delete g[m];b[k].removeAttribute("data-view-id")}f.extend(f.View.hookups,g)};v=["prepend","append","after","before","replace","text","html","replaceWith"];for(var u=0;u<v.length;u++)a(v[u])})(jQuery);
(function(f){var l={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowerUpper:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g,replacer:/\{([^\}]+)\}/g},t=function(e,c,r){c=c||window;e=e?e.split(/\./):[];for(var a,d=0;d<e.length-1&&c;d++)c=c[e[d]];a=c[e[d]];r&&delete c[e[d]];return a},o=f.String={strip:function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},capitalize:function(e){return e.charAt(0).toUpperCase()+e.substr(1)},endsWith:function(e,c){var r=e.length-c.length;return r>=0&&e.lastIndexOf(c)===
r},camelize:function(e){e=e.split(l.undHash);var c=1;for(e[0]=e[0].charAt(0).toLowerCase()+e[0].substr(1);c<e.length;c++)e[c]=o.capitalize(e[c]);return e.join("")},classize:function(e){e=e.split(l.undHash);for(var c=0;c<e.length;c++)e[c]=o.capitalize(e[c]);return e.join("")},niceName:function(e){e=e.split(l.undHash);for(var c=0;c<e.length;c++)e[c]=o.capitalize(e[c]);return e.join(" ")},underscore:function(e){return e.replace(l.colons,"/").replace(l.words,"$1_$2").replace(l.lowerUpper,"$1_$2").replace(l.dash,
"_").toLowerCase()},sub:function(e,c,r){return e.replace(l.replacer,function(a,d){return t(d,c,r).toString()})}}})(jQuery);(function(f){f.String.rsplit=function(l,t){for(var o=t.exec(l),e=[],c;o!==null;){c=o.index;if(c!==0){e.push(l.substring(0,c));l=l.slice(c)}e.push(o[0]);l=l.slice(o[0].length);o=t.exec(l)}l!==""&&e.push(l);return e}})(jQuery);
(function(f){var l=function(a){eval(a)},t=function(a){return a.substr(0,a.length-1)},o=f.extend,e=f.isArray,c=function(a){if(this.constructor!=c){var d=new c(a);return function(h,n){return d.render(h,n)}}if(typeof a=="function"){this.template={};this.template.process=a}else{f.extend(this,c.options,a);var i=new c.Compiler(this.text,this.type);i.compile(a,this.name);this.template=i}},r=/(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/;f.EJS=c;c.prototype={constructor:c,render:function(a,d){a=a||
{};this._extra_helpers=d;d=new c.Helpers(a,d||{});return this.template.process.call(a,a,d)},out:function(){return this.template.out}};c.text=function(a){if(typeof a=="string")return a;var d;if(a===null||a===undefined)return"";if(a instanceof Date)return a.toDateString();if(a.hookup){d=f.View.hookup(function(i,h){a.hookup.call(a,i,h)});return"data-view-id='"+d+"'"}if(typeof a=="function")return"data-view-id='"+f.View.hookup(a)+"'";if(e(a)){d=f.View.hookup(function(i,h){for(var n=0;n<a.length;n++)a[n].hookup?
a[n].hookup(i,h):a[n](i,h)});return"data-view-id='"+d+"'"}if(a.nodeName||a.jQuery)throw"elements in views are not supported";if(a.toString)return d?a.toString(d):a.toString();return""};c.Scanner=function(a,d,i){o(this,{leftDelimiter:d+"%",rightDelimiter:"%"+i,doubleLeft:d+"%%",doubleRight:"%%"+i,leftEqual:d+"%=",leftComment:d+"%#"});this.splitRegexp=d=="["?r:new RegExp("("+[this.doubleLeft,this.doubleRight,this.leftEqual,this.leftComment,this.leftDelimiter,this.rightDelimiter+"\n",this.rightDelimiter,
"\n"].join(")|(")+")");this.source=a;this.lines=0};c.Scanner.prototype={scan:function(a){var d=this.splitRegexp;if(this.source)for(var i=f.String.rsplit(this.source,/\n/),h=0;h<i.length;h++)this.scanline(i[h],d,a)},scanline:function(a,d,i){this.lines++;a=f.String.rsplit(a,d);for(var h=0;h<a.length;h++){d=a[h];if(d!==null)try{i(d,this)}catch(n){throw{type:"jQuery.EJS.Scanner",line:this.lines};}}}};c.Buffer=function(a,d){this.line=[];this.script=[];this.post_cmd=d;this.push.apply(this,a)};c.Buffer.prototype=
{push:function(){this.line.push.apply(this.line,arguments)},cr:function(){this.script.push(this.line.join(""),"\n");this.line=[]},close:function(){if(this.line.length>0){this.script.push(this.line.join(""));this.line=[]}this.post_cmd.length&&this.push.apply(this,this.post_cmd);this.script.push(";");return this.script.join("")}};c.Compiler=function(a,d){this.source=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n");d=d||"<";a=">";switch(d){case "[":a="]";break;case "<":break;default:throw d+" is not a supported deliminator";
}this.scanner=new c.Scanner(this.source,d,a);this.out=""};c.Compiler.prototype={compile:function(a,d){a=a||{};this.out="";var i=new c.Buffer(["var ___v1ew = [];"],[]),h="",n=function(b){return b.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')},v=function(b){i.push("___v1ew.push(",'"',n(b),'");')},u=null;this.scanner.scan(function(b,g){if(u===null)switch(b){case "\n":h+="\n";v(h);i.cr();h="";break;case g.leftDelimiter:case g.leftEqual:case g.leftComment:u=b;h.length>0&&v(h);h="";break;
case g.doubleLeft:h+=g.leftDelimiter;break;default:h+=b;break}else switch(b){case g.rightDelimiter:switch(u){case g.leftDelimiter:if(h[h.length-1]=="\n"){h=t(h);i.push(h,";");i.cr()}else i.push(h,";");break;case g.leftEqual:i.push("___v1ew.push(","(jQuery.EJS.text(",h,")));");break}u=null;h="";break;case g.doubleRight:h+=g.rightDelimiter;break;default:h+=b;break}});h.length>0&&i.push("___v1ew.push(",'"',n(h)+'");');this.out="try { with(_VIEW) { with (_CONTEXT) {"+i.close()+" return ___v1ew.join('');}}}catch(e){e.lineNumber=null;throw e;}";
l.call(this,"this.process = (function(_CONTEXT,_VIEW){"+this.out+"});\r\n//@ sourceURL="+d+".js")}};c.options={cache:true,type:"<",ext:".ejs"};c.Helpers=function(a,d){this._data=a;this._extras=d;o(this,d)};c.Helpers.prototype={plugin:function(){var a=f.makeArray(arguments),d=a.shift();return function(i){i=f(i);i[d].apply(i,a)}},view:function(a,d,i){i=i||this._extras;d=d||this._data;return f.View(a,d,i)}};f.View.register({suffix:"ejs",script:function(a,d){return"jQuery.EJS(function(_CONTEXT,_VIEW) { "+
(new c({text:d})).out()+" })"},renderer:function(a,d){var i=new c({text:d,name:a});return function(h,n){return i.render.call(i,h,n)}}})})(jQuery);
