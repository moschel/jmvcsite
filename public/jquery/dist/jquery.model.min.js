(function(e){var j=false,l=/xyz/.test(function(){})?/\b_super\b/:/.*/,a=function(b,c,g){g=g||b;for(var d in b)g[d]=typeof b[d]=="function"&&typeof c[d]=="function"&&l.test(b[d])?function(f,h){return function(){var i=this._super,k;this._super=c[f];k=h.apply(this,arguments);this._super=i;return k}}(d,b[d]):b[d]};jQuery.Class=function(){arguments.length&&this.extend.apply(this,arguments)};e.extend(e.Class,{callback:function(b){var c=jQuery.makeArray(arguments),g;b=c.shift();jQuery.isArray(b)||(b=[b]);
g=this;return function(){for(var d=c.concat(jQuery.makeArray(arguments)),f,h=b.length,i=0,k;i<h;i++)if(k=b[i]){if((f=typeof k=="string")&&g._set_called)g.called=k;d=(f?g[k]:k).apply(g,d||[]);if(i<h-1)d=!jQuery.isArray(d)||d._use_call?[d]:d}return d}},getObject:function(b,c){c=c||window;b=b?b.split(/\./):[];for(var g=0;g<b.length;g++)c=c[b[g]]||(c[b[g]]={});return c},newInstance:function(){var b=this.rawInstance(),c;if(b.setup)c=b.setup.apply(b,arguments);if(b.init)b.init.apply(b,e.isArray(c)?c:arguments);
return b},setup:function(b){this.defaults=e.extend(true,{},b.defaults,this.defaults);return arguments},rawInstance:function(){j=true;var b=new this;j=false;return b},extend:function(b,c,g){function d(){if(!j)return this.constructor!==d&&arguments.length?this.extend.apply(this,arguments):this.Class.newInstance.apply(this.Class,arguments)}if(typeof b!="string"){g=c;c=b;b=null}if(!g){g=c;c=null}g=g||{};var f=this,h=this.prototype,i,k,m,n;j=true;n=new this;j=false;a(g,h,n);for(i in this)if(this.hasOwnProperty(i)&&
e.inArray(i,["prototype","defaults","getObject"])==-1)d[i]=this[i];a(c,this,d);if(b){m=b.split(/\./);k=m.pop();m=h=e.Class.getObject(m.join("."));h[k]=d}e.extend(d,{prototype:n,namespace:m,shortName:k,constructor:d,fullName:b});d.prototype.Class=d.prototype.constructor=d;f=d.setup.apply(d,[f].concat(e.makeArray(arguments)));if(d.init)d.init.apply(d,f||[]);return d}});jQuery.Class.prototype.callback=jQuery.Class.callback})(true);
(function(e){var j={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowerUpper:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g},l=e.String={strip:function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},endsWith:function(a,b){var c=a.length-b.length;return c>=0&&a.lastIndexOf(b)===c},camelize:function(a){a=a.split(j.undHash);var b=1;for(a[0]=a[0].charAt(0).toLowerCase()+a[0].substr(1);b<a.length;b++)a[b]=l.capitalize(a[b]);
return a.join("")},classize:function(a){a=a.split(j.undHash);for(var b=0;b<a.length;b++)a[b]=l.capitalize(a[b]);return a.join("")},niceName:function(a){a=a.split(j.undHash);for(var b=0;b<a.length;b++)a[b]=l.capitalize(a[b]);return a.join(" ")},underscore:function(a){return a.replace(j.colons,"/").replace(j.words,"$1_$2").replace(j.lowerUpper,"$1_$2").replace(j.dash,"_").toLowerCase()}}})(true);
(function(e){var j=e.String.underscore,l=e.String.classize;jQuery.Class.extend("jQuery.Model",{setup:function(a){if(!this.attributes||a.attributes===this.attributes)this.attributes={};if(!this.associations||a.associations===this.associations)this.associations={};if(!this.validations||a.validations===this.validations)this.validations={};if(a.convert!=this.convert)this.convert=e.extend(a.convert,this.convert);this._fullName=j(this.fullName.replace(/\./g,"_"));if(this.fullName.substr(0,7)!="jQuery."){jQuery.Model.models[this._fullName]=
this;if(this.listType)this.list=new this.listType([])}},attributes:{},defaults:{},wrap:function(a){if(!a)return null;return new this(a[this.singularName]||a.data||a.attributes||a)},wrapMany:function(a){if(!a)return null;var b=new (this.List||e.Model.List||Array),c=e.isArray(a),g=c?a:a.data,d=g.length,f=0;for(b._use_call=true;f<d;f++)b.push(this.wrap(g[f]));if(!c)for(var h in a)if(h!=="data")b[h]=a[h];return b},id:"id",addAttr:function(a,b){if(!this.associations[a]){this.attributes[a]||(this.attributes[a]=
b);return b}},models:{},publish:function(a,b){window.OpenAjax&&OpenAjax.hub.publish(j(this.shortName)+"."+a,b)},guessType:function(a){if(typeof a!="string"){if(a===null)return typeof a;if(a.constructor==Date)return"date";if(e.isArray(a))return"array";return typeof a}if(a==="")return"string";if(a=="true"||a=="false")return"boolean";if(!isNaN(a)&&isFinite(+a))return"number";return typeof a},convert:{date:function(a){return typeof a==="string"?isNaN(Date.parse(a))?null:Date.parse(a):a},number:function(a){return parseFloat(a)},
"boolean":function(a){return Boolean(a)}},create:function(){throw"Model: Implement Create";},update:function(){throw"Model: Implement "+this.fullName+'\'s "update"!';},destroy:function(){throw"Model: Implement "+this.fullName+'\'s "destroy"!';},findAll:function(){},findOne:function(){}},{setup:function(a){this._initializing=true;this.Class.defaults&&this.attrs(this.Class.defaults);this.attrs(a);delete this._initializing},update:function(a,b,c){this.attrs(a);return this.save(b,c)},errors:function(a){if(a)a=
e.isArray(a)?a:e.makeArray(arguments);var b={},c=this,g=function(f,h){e.each(h,function(i,k){if(i=k.call(c)){b.hasOwnProperty(f)||(b[f]=[]);b[f].push(i)}})};e.each(a||this.Class.validations||{},function(f,h){if(typeof f=="number"){f=h;h=c.Class.validations[f]}g(f,h||[])});for(var d in b)if(b.hasOwnProperty(d))return b;return null},attr:function(a,b,c,g){var d=l(a),f="get"+d;if(b!==undefined){this._setProperty(a,b,c,g,d);return this}return this[f]?this[f]():this[a]},bind:function(){var a=e(this);a.bind.apply(a,
arguments);return this},unbind:function(){var a=e(this);a.unbind.apply(a,arguments);return this},_setProperty:function(a,b,c,g,d){d="set"+d;var f=this[a],h=this,i=function(k){g&&g.call(h,k);e(h).triggerHandler("error."+a,k)};this[d]&&(b=this[d](b,this.callback("_updateProperty",a,b,f,c,i),i))===undefined||this._updateProperty(a,b,f,c,i)},_updateProperty:function(a,b,c,g,d){var f=this.Class,h=f.attributes[a]||f.addAttr(a,f.guessType(b)),i=f.convert[h];h=null;b=this[a]=b===null?null:i?i.call(f,b):b;
this._initializing||(h=this.errors(a));if(h)d(h);else{c!==b&&!this._initializing&&e(this).triggerHandler(a,b);g&&g(this)}if(a==f.id&&b!==null&&f.list)if(c){if(c!=b){f.list.remove(c);f.list.push(this)}}else f.list.push(this)},attrs:function(a){var b;if(a){var c=this.Class.id;for(b in a)b!=c&&this.attr(b,a[b]);c in a&&this.attr(c,a[c])}else{a={};for(b in this.Class.attributes)if(this.Class.attributes.hasOwnProperty(b))a[b]=this.attr(b)}return a},isNew:function(){return this[this.Class.id]===undefined},
save:function(a,b){if(this.errors())return false;this.isNew()?this.Class.create(this.attrs(),this.callback(["created",a]),b):this.Class.update(this[this.Class.id],this.attrs(),this.callback(["updated",a]),b);return true},destroy:function(a,b){this.Class.destroy(this[this.Class.id],this.callback(["destroyed",a]),b)},identity:function(){var a=this[this.Class.id];return this.Class._fullName+"_"+(this.Class.escapeIdentity?encodeURIComponent(a):a)},elements:function(a){return e("."+this.identity(),a)},
publish:function(a,b){this.Class.publish(a,b||this)},hookup:function(a){var b=j(this.Class.shortName),c=e.data(a,"models")||e.data(a,"models",{});e(a).addClass(b+" "+this.identity());c[b]=this}});e.each(["created","updated","destroyed"],function(a,b){e.Model.prototype[b]=function(c){b==="destroyed"&&this.Class.list&&this.Class.list.remove(this[this.Class.id]);e(this).triggerHandler(b);c&&typeof c=="object"&&this.attrs(c.attrs?c.attrs():c);this.publish(b,this);return[this].concat(e.makeArray(arguments))}});
e.fn.models=function(){var a=[],b,c;this.each(function(){e.each(e.data(this,"models")||{},function(g,d){b=b===undefined?d.Class.List||null:d.Class.List===b?b:null;a.push(d)})});c=new (b||e.Model.List||Array);c.push.apply(c,e.unique(a));return c};e.fn.model=function(a){if(a&&a instanceof e.Model){a.hookup(this[0]);return this}else return this.models.apply(this,arguments)[0]}})(true);
